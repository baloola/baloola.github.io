

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>RFC 16: Referenceable Grid Coverages &mdash; EOxServer 0.04 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'',
              LANGUAGE:'en',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="RFC 17: Configuration of Supported Output Formats and CRSes" href="rfc17.html" />
    <link rel="prev" title="RFC 15: Access Control Support" href="rfc15.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> EOxServer
          

          
            
            <img src="../_static/EOxServer_logo_transparent.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../users/index.html">Users’ Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers/index.html">Developers’ Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Requests for Comments</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#rfc-procedures">RFC Procedures</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#writing-rfcs">Writing RFCs</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#rfcs">RFCs</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="policies.html">RFC Policies</a></li>
<li class="toctree-l3"><a class="reference internal" href="howto.html">Guidelines for Requests for Comments</a></li>
<li class="toctree-l3"><a class="reference internal" href="rfc0.html">RFC 0: Project Steering Committee Guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="rfc1.html">RFC 1: An Extensible Software Architecture for EOxServer</a></li>
<li class="toctree-l3"><a class="reference internal" href="rfc2.html">RFC 2: Extension Mechanism for EOxServer</a></li>
<li class="toctree-l3"><a class="reference internal" href="rfc3.html">RFC 3: OGC Service Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="rfc4.html">RFC 4: Data Packaging</a></li>
<li class="toctree-l3"><a class="reference internal" href="rfc5.html">RFC 5: Processing Chains</a></li>
<li class="toctree-l3"><a class="reference internal" href="rfc6.html">RFC 6: Directory Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="rfc7.html">RFC 7: Release Guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="rfc8.html">RFC 8: SVN Commit Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="rfc9.html">RFC 9: SOAP Binding of WCS GetCoverage Response</a></li>
<li class="toctree-l3"><a class="reference internal" href="rfc10.html">RFC 10: SOAP Proxy</a></li>
<li class="toctree-l3"><a class="reference internal" href="rfc11.html">RFC 11: WPS 1.0.0 Interface Prototype</a></li>
<li class="toctree-l3"><a class="reference internal" href="rfc12.html">RFC 12: Backends for the Data Access Layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="rfc13.html">RFC 13: WCS-T 1.1 Interface Prototype</a></li>
<li class="toctree-l3"><a class="reference internal" href="rfc14.html">RFC 14: Asynchronous Task Processing (ATP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="rfc15.html">RFC 15: Access Control Support</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">RFC 16: Referenceable Grid Coverages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#implementation-details">Implementation Details</a></li>
<li class="toctree-l4"><a class="reference internal" href="#voting-history">Voting History</a></li>
<li class="toctree-l4"><a class="reference internal" href="#traceability">Traceability</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="rfc17.html">RFC 17: Configuration of Supported Output Formats and CRSes</a></li>
<li class="toctree-l3"><a class="reference internal" href="rfc18.html">RFC 18: Operator Interface Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="rfc19.html">RFC 19: Migrate project repository from svn to git</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes/index.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/modules.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../copyright.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EOxServer</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Requests for Comments</a> &raquo;</li>
        
      <li>RFC 16: Referenceable Grid Coverages</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/rfc/rfc16.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="rfc-16-referenceable-grid-coverages">
<span id="rfc-16"></span><h1>RFC 16: Referenceable Grid Coverages<a class="headerlink" href="#rfc-16-referenceable-grid-coverages" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Authors:</th><td class="field-body">Stephan Krause, Stephan Meissl, Fabian Schindler</td>
</tr>
<tr class="field-even field"><th class="field-name">Created:</th><td class="field-body">2011-11-24</td>
</tr>
<tr class="field-odd field"><th class="field-name">Last Edit:</th><td class="field-body">$Date$</td>
</tr>
<tr class="field-even field"><th class="field-name">Status:</th><td class="field-body">ACCEPTED</td>
</tr>
<tr class="field-odd field"><th class="field-name">Discussion:</th><td class="field-body"><a class="reference external" href="http://www.eoxserver.org/wiki/DiscussionRfc16">http://www.eoxserver.org/wiki/DiscussionRfc16</a></td>
</tr>
</tbody>
</table>
<p>This RFC proposes an implementation for Referenceable Grid Coverages as
well as for the WCS 2.0 operations working on them.</p>
<p>The implementation is available in the SVN under
<a class="reference external" href="http://eoxserver.org/svn/sandbox/sandbox_ref">http://eoxserver.org/svn/sandbox/sandbox_ref</a>.</p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Referenceable Grid Coverages are coverages whose internal grid structure
can be mapped to a coordinate reference system by some general transformation.
They differ from rectified grid coverages in that the coordinate transformation
is not necessarily affine.</p>
<p>In the context of Earth Observation, raw satellite data can be seen as
referenceable grid coverages. They are typically delivered as image files but
do not have an affine transformation from the image geometry to a georeferenced
coordinate system. Depending on the desired geocoding precision, the
referencing transformation can be very complex involving additional data (DEMs)
and orbit metadata.</p>
<p>EOxServer shall be able to deliver (subsets of) Earth Observation raw data in
its original (referenceable grid) geometry using WCS 2.0 and EO-WCS.
Furthermore, it shall implement easily computable approximate referencing
algorithms based on ground control points (GCPs) in order to enable coordinate
transformations and rectified previews of the original data using WMS.</p>
<p>For the time being, the implementation will focus on SAR image data collected
by the ENVISAT-ASAR sensor made available by ESA.</p>
</div>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>The main requirement source for Referenceable Grid Coverage implementation in
EOxServer is the ESA O3S project. In the course of this project EOxServer shall
be installed in front of a small archive of ENVISAT-ASAR data. In a first step,
we will focus on covering the requirements of this use case, adding more generic
referenceable grid support in future iterations.</p>
<p>The ENVISAT-ASAR data are available in ENVISAT .N1 original format.</p>
<p>Delivery of the original referenceable grid data shall be supported using WCS
2.0 and EO-WCS. Subsetting shall be supported in pixel coordinates (imageCRS)
and in a coordinate reference system. The CRS subsets shall be mapped to pixel
coordinates using a simple coordinate transformation based on GCPs.</p>
<p>No support for resampling (<code class="docutils literal"><span class="pre">size</span></code> and <code class="docutils literal"><span class="pre">resolution</span></code>) or reprojection
(<code class="docutils literal"><span class="pre">outputcrs</span></code>) parameters is required as these are not applicable to
referenceable grid coverages.</p>
<p>At least GeoTIFF shall be supported as output format. GCP and metadata
information contained in the .N1 original file shall be preserved.</p>
<p>In order to support (rectified) WMS previews, a simple georeferencing algorithm
based on GCPs shall be implemented. This shall be reused to provide rectified
versions of referenceable grid coverages using WCS 2.0.</p>
</div>
<div class="section" id="implementation-details">
<h2>Implementation Details<a class="headerlink" href="#implementation-details" title="Permalink to this headline">¶</a></h2>
<div class="section" id="input-formats">
<h3>Input Formats<a class="headerlink" href="#input-formats" title="Permalink to this headline">¶</a></h3>
<p>The implementation for referenceable grid coverages relies on GDAL for input
data and metadata (georeferencing information, GCPs). Any format that supports
storage of GCPs with the dataset can be used. The two most important formats
are the ENVISAT .N1 format and GeoTiff.</p>
</div>
<div class="section" id="referencing-algorithm-and-subsetting">
<h3>Referencing Algorithm and Subsetting<a class="headerlink" href="#referencing-algorithm-and-subsetting" title="Permalink to this headline">¶</a></h3>
<p>WCS 2.0 allows to define subsets either in the image CRS, i.e. pixel
coordinates, or in some geographic or projected coordinate system. For
rectified grid coverages geographic coordinates can be easily transformed to
pixel coordinates in a straightforward way. This is not the case for
referenceable grid coverages, though.</p>
<p>For referenceable grid coverages produced by Earth Observation missions, the
“correct” referencing transformation is not known in general. Instead, there
are many different algorithms some of them relying on different additional data
and metadata (DEMs, orbit information).</p>
<p>For the purposes of the EOxServer Referenceable Grid Coverage implementation,
a simple first order interpolation algorithm based on GCPs is used. This
algorithm does not use any additional data or metadata. The rationale for this
decision is that there is no way to advertise the actual referencing algorithm
in WCS or WMS, and therefore the most simple and straightfoward algorithm was
used.</p>
<p>Subsets given in georeferenced coordinates are transformed to the image CRS
using the inverse transformation algorithm based on GCPs. The implementation
uses not only the corner coordinates of the subsetting rectangle but also
intermediary points to calculate an envelope and thus to guarantee that the
requested extent be included in the result.</p>
</div>
<div class="section" id="genuine-referenceable-grid-coverage-support-in-wcs-2-0">
<h3>Genuine Referenceable Grid Coverage Support in WCS 2.0<a class="headerlink" href="#genuine-referenceable-grid-coverage-support-in-wcs-2-0" title="Permalink to this headline">¶</a></h3>
<p>Referenceable Grid Coverages in their original geometry are available using
the EO-WCS extension of WCS 2.0.</p>
<p>The current implementation supports the <code class="docutils literal"><span class="pre">subset</span></code> parameter and transforms the
given subsets as indicated in the previous subsection. The <code class="docutils literal"><span class="pre">size</span></code>
and <code class="docutils literal"><span class="pre">resolution</span></code> parameters are not supported as they do only apply to
rectified grid coverages.</p>
<p>The <code class="docutils literal"><span class="pre">format</span></code> parameter options are implemented in the same way as for
rectified grid coverages.</p>
<p>The <code class="docutils literal"><span class="pre">rangesubset</span></code> parameter is foreseen for implementation.</p>
<p>In order to be able to serve referenceable grid data, the original
<code class="xref py py-class docutils literal"><span class="pre">WCS20GetCoverageHandler</span></code> was split up into
<code class="xref py py-class docutils literal"><span class="pre">WCS20GetReferenceableCoverageHandler</span></code> and
<code class="xref py py-class docutils literal"><span class="pre">WCS20GetRectifiedCoverageHandler</span></code>. While the latter one still relies
on MapServer, the one for referenceable grid data uses the vanilla GDAL Python
bindings as well as additional GDAL-based extensions written for the
EOxServer project.</p>
<p>Metadata is read from the original dataset and tagged onto the result dataset
using the capabilities of the respective GDAL format drivers. Depending on
the driver implementation, the way the metadata is stored may be specific to
GDAL.</p>
</div>
<div class="section" id="coverage-metadata-tayloring">
<h3>Coverage Metadata Tayloring<a class="headerlink" href="#coverage-metadata-tayloring" title="Permalink to this headline">¶</a></h3>
<p>The WCS 2.0 standard specifies that the complete referencing transformation be
described in the metadata of a referenceable grid coverage. This is a major
problem for Earth Observation data as in general there is no predefined
transformation; rather there are several different possible algorithms of
varying complexity that can be used for georeferencing the image, possibly
involving Earth Observation metadata such as orbit information, GCPs and
additional data such as DEMs.</p>
<p>Furthermore there is no way to define an algorithm and describe its
parameters (e.g. the GCPs) in GML, but only the outcome of the algorithm, i.e. a
pixel-by-pixel mapping to geographic coordinates. This would produce a
tremendous amount of mostly useless metadata and blow up the XML descriptions
of coverage metadata to hundreds of megabytes for typical Earth Observation
products.</p>
<p>Therefore the current EOxServer implementation does not deliver any of the
<code class="docutils literal"><span class="pre">gml:AbstractReferenceableGrid</span></code> extensions in its metadata. Instead a
non-standard <code class="docutils literal"><span class="pre">ReferenceableGrid</span></code> element is returned that contains all the
elements inherited from <code class="docutils literal"><span class="pre">gml:Grid</span></code> but no further information. This is only a
provisional solution that will be changed as soon as an appropriate way to
describe referencing metadata is defined by the WCS 2.0 standard or any of its
successors.</p>
</div>
<div class="section" id="support-for-rectified-data-in-wms-and-wcs-2-0">
<h3>Support for Rectified Data in WMS and WCS 2.0<a class="headerlink" href="#support-for-rectified-data-in-wms-and-wcs-2-0" title="Permalink to this headline">¶</a></h3>
<p>The implementation of the WCS 2.0 (EO-WCS) GetCoverage request as well as
the WMS implementation is based on MapServer which supports rectified grid
coverages only. It is not possible to use any kind of GCP based referencing
algorithm in MapServer directly.</p>
<p>GDAL provides a mechanism to create so-called virtual raster datasets (VRT).
These consist of an XML file describing the parameters for transformation,
warping and other possible operations on raster data. They can be generated
using the GDAL C API and are readable by MapServer (which relies on GDAL as
well).</p>
<p>In order to provide referenced versions of referenceable data, EOxServer creates
such VRTs on the fly using the EOxServer GDAL extension. The VRT files are
deleted after each request.</p>
</div>
<div class="section" id="gdal-extension">
<h3>GDAL Extension<a class="headerlink" href="#gdal-extension" title="Permalink to this headline">¶</a></h3>
<p>The EOxServer GDAL extension provides a Python binding to some C functions using
the GDAL C API that implement utilities for handling referenceable grid
coverages. At the moment the Python bindings are implemented using the
Python <a class="reference external" href="http://docs.python.org/library/ctypes.html">ctypes</a> module.</p>
<p>The <code class="xref py py-mod docutils literal"><span class="pre">eoxserver.processing.gdal.reftools</span></code> module contains functions
for</p>
<ul class="simple">
<li>computing the pixel coordinate envelope from a georeferenced subset</li>
<li>computing the footprint of a referenceable grid coverage</li>
<li>creating a rectified GDAL VRT from referenceable grid data</li>
</ul>
<p>All functions use a simple GCP-based referencing algorithm as indicated above.</p>
<p>The GDAL Extension was made necessary because the standard GDAL Python bindings
do not support GCP based coordinate transformations.</p>
</div>
</div>
<div class="section" id="voting-history">
<h2>Voting History<a class="headerlink" href="#voting-history" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Motion:</th><td class="field-body">Adopted on  2012-01-03 with +1 from Arndt Bonitz, Martin Paces,
Fabian Schindler, Stephan Meißl and +0 from Milan Novacek</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="traceability">
<h2>Traceability<a class="headerlink" href="#traceability" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Requirements:</th><td class="field-body">“N/A”</td>
</tr>
<tr class="field-even field"><th class="field-name">Tickets:</th><td class="field-body">“N/A”</td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="rfc17.html" class="btn btn-neutral float-right" title="RFC 17: Configuration of Supported Output Formats and CRSes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="rfc15.html" class="btn btn-neutral float-left" title="RFC 15: Access Control Support" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; <a href="../copyright.html">Copyright</a> 2011, 2012, 2013, 2014, EOX IT Services GmbH
      <span class="lastupdated">
        Last updated on 2019-06-19T12:43:22Z.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>